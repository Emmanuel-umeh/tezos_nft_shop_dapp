{"ast":null,"code":"import _regeneratorRuntime from \"/opt/tezos/nft-shop-example/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { Serializer } from '../../Serializer';\nimport { generateGUID } from '../../utils/generate-uuid';\nimport { Logger } from '../../utils/Logger';\nimport { isAndroid, isIOS } from '../../utils/platform';\nimport { closeAlerts } from './Alert';\nimport { Pairing, WalletType } from './Pairing';\nimport { getQrData } from '../../utils/qr';\nimport { getTzip10Link } from '../../utils/get-tzip10-link';\nvar logger = new Logger('Alert');\nvar serializer = new Serializer();\nexport var preparePairingAlert = function preparePairingAlert(shadowRoot, pairingPayload) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n    var info, container, buttonListWrapper, qr, copyButton, titleEl, platform, mainText, walletList, switchButton, fn, qrShown, showPlatform, showQr, switchPlatform, platformSwitch;\n    return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            _context9.next = 2;\n            return Pairing.getPairingInfo(pairingPayload, function (_walletType, _wallet, keepOpen) {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        if (!keepOpen) {\n                          _context.next = 2;\n                          break;\n                        }\n\n                        return _context.abrupt(\"return\");\n\n                      case 2:\n                        _context.next = 4;\n                        return closeAlerts();\n\n                      case 4:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee);\n              }));\n            }, function () {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        switchPlatform();\n\n                      case 1:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, _callee2);\n              }));\n            });\n\n          case 2:\n            info = _context9.sent;\n            container = shadowRoot.getElementById(\"pairing-container\");\n\n            if (container) {\n              _context9.next = 6;\n              break;\n            }\n\n            throw new Error('container not found');\n\n          case 6:\n            buttonListWrapper = document.createElement('span');\n            container.appendChild(buttonListWrapper);\n            info.buttons.forEach(function (button) {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n                var randomId, x, el, buttonEl;\n                return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                  while (1) {\n                    switch (_context4.prev = _context4.next) {\n                      case 0:\n                        _context4.next = 2;\n                        return generateGUID();\n\n                      case 2:\n                        randomId = _context4.sent;\n                        x = \"\\n    <div class=\\\"beacon-list__title\\\">\".concat(button.title, \"</div>\\n\\t\\t<button class=\\\"beacon-modal__button connect__btn\\\">\").concat(button.text, \"</button>\\n\\t\\t \");\n                        el = document.createElement('a');\n                        el.id = \"button_\".concat(randomId);\n                        el.innerHTML = x;\n                        buttonListWrapper.appendChild(el);\n                        buttonEl = shadowRoot.getElementById(el.id);\n\n                        if (buttonEl) {\n                          buttonEl.addEventListener('click', function () {\n                            return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n                              return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                                while (1) {\n                                  switch (_context3.prev = _context3.next) {\n                                    case 0:\n                                      button.clickHandler();\n\n                                    case 1:\n                                    case \"end\":\n                                      return _context3.stop();\n                                  }\n                                }\n                              }, _callee3);\n                            }));\n                          });\n                        }\n\n                      case 10:\n                      case \"end\":\n                        return _context4.stop();\n                    }\n                  }\n                }, _callee4);\n              }));\n            });\n            info.walletLists.forEach(function (list) {\n              var listWrapperEl = document.createElement('div');\n              listWrapperEl.classList.add('beacon-list__wrapper');\n              container.appendChild(listWrapperEl);\n              var listTitleEl = document.createElement('div');\n              listTitleEl.classList.add('beacon-list__title');\n              listTitleEl.innerHTML = list.title;\n              listWrapperEl.appendChild(listTitleEl);\n              var listEl = document.createElement('span');\n              listWrapperEl.appendChild(listEl);\n              list.wallets.forEach(function (wallet) {\n                return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n                  var altTag, walletKey, x, el, walletEl, completeHandler;\n                  return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                    while (1) {\n                      switch (_context6.prev = _context6.next) {\n                        case 0:\n                          altTag = \"Open in \".concat(wallet.name);\n                          walletKey = wallet.key;\n                          x = \"\\n\\t\\t\\t<a tabindex=\\\"0\\\" alt=\\\"\".concat(altTag, \"\\\" id=\\\"wallet_\").concat(walletKey, \"\\\"\\n\\t\\t\\t target=\\\"_blank\\\" class=\\\"beacon-selection__list\").concat(wallet.enabled ? '' : ' disabled', \"\\\">\\n\\t\\t\\t <div class=\\\"beacon-selection__name\\\">\").concat(wallet.name, \"\\n\\t\\t\\t \").concat(wallet.enabled ? '' : '<p>Not installed</p>', \"\\n\\t\\t\\t </div>\\n\\t\\t\\t \").concat(wallet.logo ? \"<div>\\n\\t\\t\\t <img class=\\\"beacon-selection__img\\\" src=\\\"\".concat(wallet.logo, \"\\\"/>\\n\\t\\t\\t </div>\") : '<svg class=\"beacon-selection__img\" aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"wallet\" class=\"svg-inline--fa fa-wallet fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" style=\"enable-background:new 0 0 512 512;\" xml:space=\"preserve\"><path d=\"M376.2,181H152.9c-5.2,0-9.4-4.2-9.4-9.4s4.2-9.4,9.4-9.4h225c5.2,0,9.4-4.2,9.4-9.4c0-15.5-12.6-28.1-28.1-28.1H143.5c-20.7,0-37.5,16.8-37.5,37.5v187.5c0,20.7,16.8,37.5,37.5,37.5h232.7c16.4,0,29.8-12.6,29.8-28.1v-150C406,193.6,392.7,181,376.2,181z M349.8,302.9c-10.4,0-18.8-8.4-18.8-18.8s8.4-18.8,18.8-18.8s18.8,8.4,18.8,18.8S360.1,302.9,349.8,302.9z\"/></svg>', \"\\n\\t\\t\\t</a>\\n\\t\\t\\t \");\n                          el = document.createElement('span');\n                          el.innerHTML = x;\n                          listEl.appendChild(el);\n                          walletEl = shadowRoot.getElementById(\"wallet_\".concat(walletKey));\n\n                          completeHandler = function completeHandler(event) {\n                            return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n                              var modalEl;\n                              return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                                while (1) {\n                                  switch (_context5.prev = _context5.next) {\n                                    case 0:\n                                      if (!(event && event.key !== 'Enter')) {\n                                        _context5.next = 2;\n                                        break;\n                                      }\n\n                                      return _context5.abrupt(\"return\");\n\n                                    case 2:\n                                      wallet.clickHandler();\n                                      modalEl = shadowRoot.getElementById('beacon-modal__content');\n\n                                      if (modalEl && list.type !== WalletType.EXTENSION && list.type !== WalletType.IOS) {\n                                        modalEl.innerHTML = \"\".concat(wallet.logo ? \"<p class=\\\"beacon-alert__title\\\">Establishing Connection..</p>\\n              <div id=\\\"beacon-toast-loader\\\" class=\\\"progress-line\\\"></div>\\n              <div class=\\\"beacon--selected__container\\\">\\n               <img class=\\\"beacon-selection__img\\\" src=\\\"\".concat(wallet.logo, \"\\\"/>\\n               <div class=\\\"beacon--selection__name__lg\\\">\").concat(wallet.name, \"</div>\\n              </div>\") : '', \"\\n          \");\n                                      }\n\n                                    case 5:\n                                    case \"end\":\n                                      return _context5.stop();\n                                  }\n                                }\n                              }, _callee5);\n                            }));\n                          };\n\n                          if (walletEl) {\n                            walletEl.addEventListener('click', function () {\n                              return completeHandler();\n                            });\n                            walletEl.addEventListener('keydown', completeHandler);\n                          }\n\n                        case 9:\n                        case \"end\":\n                          return _context6.stop();\n                      }\n                    }\n                  }, _callee6);\n                }));\n              });\n            });\n            qr = shadowRoot.getElementById(\"beacon--qr__container\");\n            copyButton = shadowRoot.getElementById(\"beacon--qr__copy\");\n            titleEl = shadowRoot.getElementById(\"beacon-title\");\n            platform = isAndroid(window) ? 'android' : isIOS(window) ? 'ios' : 'desktop';\n            mainText = shadowRoot.getElementById(\"beacon-main-text\");\n            walletList = shadowRoot.getElementById(\"pairing-container\");\n            switchButton = shadowRoot.getElementById(\"beacon--switch__container\"); // if (mainText && walletList && switchButton && copyButton && qr && titleEl) {\n\n            fn = function fn() {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n                var code;\n                return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n                  while (1) {\n                    switch (_context7.prev = _context7.next) {\n                      case 0:\n                        if (!pairingPayload) {\n                          _context7.next = 10;\n                          break;\n                        }\n\n                        _context7.t1 = serializer;\n                        _context7.next = 4;\n                        return pairingPayload.p2pSyncCode();\n\n                      case 4:\n                        _context7.t2 = _context7.sent;\n                        _context7.next = 7;\n                        return _context7.t1.serialize.call(_context7.t1, _context7.t2);\n\n                      case 7:\n                        _context7.t0 = _context7.sent;\n                        _context7.next = 11;\n                        break;\n\n                      case 10:\n                        _context7.t0 = '';\n\n                      case 11:\n                        code = _context7.t0;\n                        navigator.clipboard.writeText(code).then(function () {\n                          if (copyButton) {\n                            copyButton.innerText = 'Copied';\n                          }\n\n                          logger.log('Copying to clipboard was successful!');\n                        }, function (err) {\n                          logger.error('Could not copy text to clipboard: ', err);\n                        });\n\n                      case 13:\n                      case \"end\":\n                        return _context7.stop();\n                    }\n                  }\n                }, _callee7);\n              }));\n            };\n\n            qrShown = false;\n\n            showPlatform = function showPlatform(type) {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n                var platformSwitch, code, uri, qrSVG, qrString;\n                return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                  while (1) {\n                    switch (_context8.prev = _context8.next) {\n                      case 0:\n                        platformSwitch = shadowRoot.getElementById(\"beacon-switch\");\n\n                        if (platformSwitch) {\n                          platformSwitch.innerHTML = type === 'none' ? 'Pair wallet on same device' : 'Pair wallet on another device';\n                        }\n\n                        if (!(mainText && walletList && switchButton && copyButton && qr && titleEl)) {\n                          _context8.next = 35;\n                          break;\n                        }\n\n                        mainText.style.display = 'none';\n                        titleEl.style.textAlign = 'center';\n                        walletList.style.display = 'none';\n                        switchButton.style.display = 'initial';\n                        _context8.t0 = type;\n                        _context8.next = _context8.t0 === 'ios' ? 10 : _context8.t0 === 'android' ? 12 : _context8.t0 === 'desktop' ? 14 : 19;\n                        break;\n\n                      case 10:\n                        walletList.style.display = 'initial';\n                        return _context8.abrupt(\"break\", 35);\n\n                      case 12:\n                        walletList.style.display = 'initial';\n                        return _context8.abrupt(\"break\", 35);\n\n                      case 14:\n                        walletList.style.display = 'initial';\n                        titleEl.style.textAlign = 'left';\n                        mainText.style.display = 'none';\n                        switchButton.style.display = 'initial';\n                        return _context8.abrupt(\"break\", 35);\n\n                      case 19:\n                        if (qrShown) {\n                          _context8.next = 34;\n                          break;\n                        }\n\n                        _context8.t1 = serializer;\n                        _context8.next = 23;\n                        return pairingPayload.p2pSyncCode();\n\n                      case 23:\n                        _context8.t2 = _context8.sent;\n                        _context8.next = 26;\n                        return _context8.t1.serialize.call(_context8.t1, _context8.t2);\n\n                      case 26:\n                        code = _context8.sent;\n                        uri = getTzip10Link('tezos://', code);\n                        qrSVG = getQrData(uri, 'svg');\n                        qrString = qrSVG.replace('<svg', \"<svg class=\\\"beacon-alert__image\\\"\");\n                        qr.insertAdjacentHTML('afterbegin', qrString);\n\n                        if (copyButton) {\n                          copyButton.addEventListener('click', fn);\n                        }\n\n                        if (qr) {\n                          qr.addEventListener('click', fn);\n                        }\n\n                        qrShown = true;\n\n                      case 34:\n                        // QR code\n                        mainText.style.display = 'initial';\n\n                      case 35:\n                      case \"end\":\n                        return _context8.stop();\n                    }\n                  }\n                }, _callee8);\n              }));\n            };\n\n            showQr = false;\n\n            switchPlatform = function switchPlatform() {\n              showPlatform(showQr ? 'none' : platform);\n              showQr = !showQr;\n            };\n\n            switchPlatform();\n            platformSwitch = shadowRoot.getElementById(\"beacon-switch\");\n\n            if (platformSwitch) {\n              platformSwitch.addEventListener('click', switchPlatform);\n            }\n\n          case 25:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, _callee9);\n  }));\n};","map":{"version":3,"sources":["../../../../src/ui/alert/PairingAlert.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Serializer } from '../../Serializer';\nimport { generateGUID } from '../../utils/generate-uuid';\nimport { Logger } from '../../utils/Logger';\nimport { isAndroid, isIOS } from '../../utils/platform';\nimport { closeAlerts } from './Alert';\nimport { Pairing, WalletType } from './Pairing';\nimport { getQrData } from '../../utils/qr';\nimport { getTzip10Link } from '../../utils/get-tzip10-link';\nconst logger = new Logger('Alert');\nconst serializer = new Serializer();\nexport const preparePairingAlert = (shadowRoot, pairingPayload) => __awaiter(void 0, void 0, void 0, function* () {\n    const info = yield Pairing.getPairingInfo(pairingPayload, (_walletType, _wallet, keepOpen) => __awaiter(void 0, void 0, void 0, function* () {\n        if (keepOpen) {\n            return;\n        }\n        yield closeAlerts();\n    }), () => __awaiter(void 0, void 0, void 0, function* () {\n        switchPlatform();\n    }));\n    const container = shadowRoot.getElementById(`pairing-container`);\n    if (!container) {\n        throw new Error('container not found');\n    }\n    const buttonListWrapper = document.createElement('span');\n    container.appendChild(buttonListWrapper);\n    info.buttons.forEach((button) => __awaiter(void 0, void 0, void 0, function* () {\n        const randomId = yield generateGUID();\n        const x = `\n    <div class=\"beacon-list__title\">${button.title}</div>\n\t\t<button class=\"beacon-modal__button connect__btn\">${button.text}</button>\n\t\t `;\n        const el = document.createElement('a');\n        el.id = `button_${randomId}`;\n        el.innerHTML = x;\n        buttonListWrapper.appendChild(el);\n        const buttonEl = shadowRoot.getElementById(el.id);\n        if (buttonEl) {\n            buttonEl.addEventListener('click', () => __awaiter(void 0, void 0, void 0, function* () {\n                button.clickHandler();\n            }));\n        }\n    }));\n    info.walletLists.forEach((list) => {\n        const listWrapperEl = document.createElement('div');\n        listWrapperEl.classList.add('beacon-list__wrapper');\n        container.appendChild(listWrapperEl);\n        const listTitleEl = document.createElement('div');\n        listTitleEl.classList.add('beacon-list__title');\n        listTitleEl.innerHTML = list.title;\n        listWrapperEl.appendChild(listTitleEl);\n        const listEl = document.createElement('span');\n        listWrapperEl.appendChild(listEl);\n        list.wallets.forEach((wallet) => __awaiter(void 0, void 0, void 0, function* () {\n            const altTag = `Open in ${wallet.name}`;\n            const walletKey = wallet.key;\n            const x = `\n\t\t\t<a tabindex=\"0\" alt=\"${altTag}\" id=\"wallet_${walletKey}\"\n\t\t\t target=\"_blank\" class=\"beacon-selection__list${wallet.enabled ? '' : ' disabled'}\">\n\t\t\t <div class=\"beacon-selection__name\">${wallet.name}\n\t\t\t ${wallet.enabled ? '' : '<p>Not installed</p>'}\n\t\t\t </div>\n\t\t\t ${wallet.logo\n                ? `<div>\n\t\t\t <img class=\"beacon-selection__img\" src=\"${wallet.logo}\"/>\n\t\t\t </div>`\n                : '<svg class=\"beacon-selection__img\" aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"wallet\" class=\"svg-inline--fa fa-wallet fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" style=\"enable-background:new 0 0 512 512;\" xml:space=\"preserve\"><path d=\"M376.2,181H152.9c-5.2,0-9.4-4.2-9.4-9.4s4.2-9.4,9.4-9.4h225c5.2,0,9.4-4.2,9.4-9.4c0-15.5-12.6-28.1-28.1-28.1H143.5c-20.7,0-37.5,16.8-37.5,37.5v187.5c0,20.7,16.8,37.5,37.5,37.5h232.7c16.4,0,29.8-12.6,29.8-28.1v-150C406,193.6,392.7,181,376.2,181z M349.8,302.9c-10.4,0-18.8-8.4-18.8-18.8s8.4-18.8,18.8-18.8s18.8,8.4,18.8,18.8S360.1,302.9,349.8,302.9z\"/></svg>'}\n\t\t\t</a>\n\t\t\t `;\n            const el = document.createElement('span');\n            el.innerHTML = x;\n            listEl.appendChild(el);\n            const walletEl = shadowRoot.getElementById(`wallet_${walletKey}`);\n            const completeHandler = (event) => __awaiter(void 0, void 0, void 0, function* () {\n                if (event && event.key !== 'Enter') {\n                    return;\n                }\n                wallet.clickHandler();\n                const modalEl = shadowRoot.getElementById('beacon-modal__content');\n                if (modalEl && list.type !== WalletType.EXTENSION && list.type !== WalletType.IOS) {\n                    modalEl.innerHTML = `${wallet.logo\n                        ? `<p class=\"beacon-alert__title\">Establishing Connection..</p>\n              <div id=\"beacon-toast-loader\" class=\"progress-line\"></div>\n              <div class=\"beacon--selected__container\">\n               <img class=\"beacon-selection__img\" src=\"${wallet.logo}\"/>\n               <div class=\"beacon--selection__name__lg\">${wallet.name}</div>\n              </div>`\n                        : ''}\n          `;\n                }\n            });\n            if (walletEl) {\n                walletEl.addEventListener('click', () => completeHandler());\n                walletEl.addEventListener('keydown', completeHandler);\n            }\n        }));\n    });\n    const qr = shadowRoot.getElementById(`beacon--qr__container`);\n    const copyButton = shadowRoot.getElementById(`beacon--qr__copy`);\n    const titleEl = shadowRoot.getElementById(`beacon-title`);\n    const platform = isAndroid(window) ? 'android' : isIOS(window) ? 'ios' : 'desktop';\n    const mainText = shadowRoot.getElementById(`beacon-main-text`);\n    const walletList = shadowRoot.getElementById(`pairing-container`);\n    const switchButton = shadowRoot.getElementById(`beacon--switch__container`);\n    // if (mainText && walletList && switchButton && copyButton && qr && titleEl) {\n    const fn = () => __awaiter(void 0, void 0, void 0, function* () {\n        const code = pairingPayload\n            ? yield serializer.serialize(yield pairingPayload.p2pSyncCode())\n            : '';\n        navigator.clipboard.writeText(code).then(() => {\n            if (copyButton) {\n                copyButton.innerText = 'Copied';\n            }\n            logger.log('Copying to clipboard was successful!');\n        }, (err) => {\n            logger.error('Could not copy text to clipboard: ', err);\n        });\n    });\n    let qrShown = false;\n    const showPlatform = (type) => __awaiter(void 0, void 0, void 0, function* () {\n        const platformSwitch = shadowRoot.getElementById(`beacon-switch`);\n        if (platformSwitch) {\n            platformSwitch.innerHTML =\n                type === 'none' ? 'Pair wallet on same device' : 'Pair wallet on another device';\n        }\n        if (mainText && walletList && switchButton && copyButton && qr && titleEl) {\n            mainText.style.display = 'none';\n            titleEl.style.textAlign = 'center';\n            walletList.style.display = 'none';\n            switchButton.style.display = 'initial';\n            switch (type) {\n                case 'ios':\n                    walletList.style.display = 'initial';\n                    break;\n                case 'android':\n                    walletList.style.display = 'initial';\n                    break;\n                case 'desktop':\n                    walletList.style.display = 'initial';\n                    titleEl.style.textAlign = 'left';\n                    mainText.style.display = 'none';\n                    switchButton.style.display = 'initial';\n                    break;\n                default:\n                    if (!qrShown) {\n                        const code = yield serializer.serialize(yield pairingPayload.p2pSyncCode());\n                        const uri = getTzip10Link('tezos://', code);\n                        const qrSVG = getQrData(uri, 'svg');\n                        const qrString = qrSVG.replace('<svg', `<svg class=\"beacon-alert__image\"`);\n                        qr.insertAdjacentHTML('afterbegin', qrString);\n                        if (copyButton) {\n                            copyButton.addEventListener('click', fn);\n                        }\n                        if (qr) {\n                            qr.addEventListener('click', fn);\n                        }\n                        qrShown = true;\n                    }\n                    // QR code\n                    mainText.style.display = 'initial';\n            }\n        }\n    });\n    let showQr = false;\n    const switchPlatform = () => {\n        showPlatform(showQr ? 'none' : platform);\n        showQr = !showQr;\n    };\n    switchPlatform();\n    {\n        const platformSwitch = shadowRoot.getElementById(`beacon-switch`);\n        if (platformSwitch) {\n            platformSwitch.addEventListener('click', switchPlatform);\n        }\n    }\n});\n//# sourceMappingURL=PairingAlert.js.map"]},"metadata":{},"sourceType":"module"}